<project name="service compilation file" basedir=".">
	
	
	<!-- Define the environment variable -->
	<property environment="env"/>
	
	<property name="c3grid.basedir" value="${basedir}"/>
	<property file="c3grid.properties"/>
	<property file="c3grid.deps"/>
	
	<!-- Building stubs for every service -->
	<target name='stubs.compile'>
		<exec executable="sh">
			<arg value="-c"/>
			<arg value="for i in services/* ; do ( cd $i &amp;&amp; ant compileStubs ) ; done"/>
		</exec>
	</target>
	
	<!-- class-files needed to compile DSpace -->
	<path id="dspace.path">
		<pathelement path="${GROOVY}"/> 
		<pathelement path="${annotations}"/>
		<dirset dir="${dspace.stubs}" />
		<pathelement path="${gndms-infra}"/>
		<pathelement location="${gndms-kit}"/>
		<pathelement location="${gndms-logic}"/>
		<pathelement location="${gndms-shared-model}"/>
		<pathelement location="${stuff}"/>
		<pathelement path="${joda-time}"/> 
		<dirset dir="${dspace.dir}/src/" />
		<pathelement path="${dspace.nonsym}"/>
		<pathelement path="${gt4}"/>
		<pathelement path="${openjpa}"/>
		<pathelement path="${guice}"/>
	</path>
	
	<!-- class-files needed to compile GORFX -->
	<path id="gorfx.path">
		<pathelement path="${GROOVY}"/> 
		<pathelement path="${annotations}"/>
		<dirset dir="${gorfx.dir}/build/stubs-GORFX/classes/" />
		<pathelement location="${gndms-typecon}"/>
		<pathelement location="${gndms-infra}"/>
		<pathelement location="${gndms-kit}"/>
		<pathelement location="${gndms-logic}"/>
		<pathelement location="${gndms-shared-model}"/>
		<pathelement location="${stuff}"/>
		<pathelement location="${joda-time}"/> 
		<dirset dir="${gorfx.dir}/src/" />
		<pathelement path="${gorfx.nonsym}"/>
		<pathelement path="${gt4}"/>
		<pathelement path="${openjpa}"/>
		<pathelement location="${lib.dir}/DSpace.jar"/>
		<pathelement path="${args4j}"/>
		<dirset dir="${dspace.dir}/build/stubs-DSpace/classes/" />
		<pathelement path="${jaxb}"/>
		<pathelement path="${guice}"/>
	</path>
	<!-- Building all services -->
	<target name='services.compile'>
		<mkdir dir="tmp"/>
		<javac srcdir='${dspace.dir}/src' destdir='tmp' classpathref="dspace.path" debug="${javac.debug}" />
		<jar destfile="${lib.dir}/DSpace.jar"
		     basedir="tmp">
		</jar>
		<delete dir="tmp"/>
		<mkdir dir="tmp"/>
		<javac srcdir='${gorfx.dir}/src' destdir='tmp' classpathref="gorfx.path" debug="${javac.debug}"/>
		<jar destfile="${gorfx.dir}/GORFX.jar"
		     basedir="tmp">
		</jar>
		<delete dir="tmp"/>
		<exec executable="sh">
			<arg value="-c"/>
			<arg value="for i in services/* ; do ( cd $i &amp;&amp; ant createDeploymentGar ) ; done"/>
		</exec>
	</target>
	
	<target name="clean.stubsServices">
		<exec executable="sh">
			<arg value="-c"/>
			<arg value="for i in services/* ; do ( cd $i &amp;&amp; ant preClean ) ; done"/>
		</exec>
		<delete includeemptydirs="true">
			<fileset dir="services" includes="**/build/"/>	
		</delete>
		<exec executable="sh">
			<arg value="-c"/>
			<arg value="for i in services/* ; do ( cd $i &amp;&amp; ant postClean ) ; done"/>
		</exec>
	</target>
</project>




