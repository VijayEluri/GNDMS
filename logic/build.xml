<project name="logic compilation file" default="logic.compile" basedir=".">
	
	
	<path id="logic.path">
		
		<pathelement location="${tools-lib.dir}/gndms-groovy.jar"/> 

		<pathelement location="${tools-lib.dir}/annotations.jar"/>
		<dirset dir="${logic.dest}/production"/>
        <pathelement location="${lib.dir}/gndms-stuff.jar"/>                
		<pathelement location="${lib.dir}/gndms-shared-model.jar"/>
		<pathelement location="${tools-lib.dir}/testng-5.8-jdk15.jar"/> 
		<pathelement location="${tools-lib.dir}/commons-collections-3.2.jar "/>
		<pathelement location="${tools-lib.dir}/commons-lang-2.1.jar "/>
		<pathelement location="${tools-lib.dir}/commons-pool-1.3.jar"/>
		<pathelement location="${tools-lib.dir}/derbyclient.jar"/>
		<pathelement location="${tools-lib.dir}/derby.jar"/>
		<pathelement location="${tools-lib.dir}/derbyLocale_de_DE.jar"/>
		<pathelement location="${tools-lib.dir}/derbynet.jar"/>
		<pathelement location="${tools-lib.dir}/derbyrun.jar"/>
		<pathelement location="${tools-lib.dir}/derbytools.jar"/>
		<pathelement location="${tools-lib.dir}/joda-time-1.5.2.jar"/> 
		<pathelement location="${lib.dir}/gndms-kit.jar"/>
		<pathelement location="${tools-lib.dir}/google-collect-snapshot-20080820.jar"/>
		<fileset refid="globus.lib"/>
		<pathelement location="${tools-lib.dir}/geronimo-jpa_3.0_spec-1.0.jar"/>
		<pathelement location="${tools-lib.dir}/geronimo-jta_1.1_spec-1.1.jar"/>
		<pathelement location="${tools-lib.dir}/serp-1.13.1.jar"/>
		<pathelement location="${tools-lib.dir}/openjpa-1.1.0.jar"/>
                <pathelement location="${tools-lib.dir}/guice-snapshot20081123.jar"/>
                <pathelement location="${tools-lib.dir}/guice-assistedinject-snapshot20081123.jar"/>
                <pathelement location="${tools-lib.dir}/guice-multibindings-snapshot20081123.jar"/>
                <pathelement location="${tools-lib.dir}/guice-throwingproviders-snapshot20081123.jar"/>
                <pathelement location="${tools-lib.dir}/asm-3.1.jar"/>
                <pathelement location="${tools-lib.dir}/cglib-2.2.jar"/>
		
         	<!--fileset dir="${tools-lib.dir}" includes="*.jar" /-->
		

		
	</path>
	<!-- Compile logic, but not its test-files -->	
	<target name="logic.compile" description="Compiles logic">
		<if>
			<not>
				<and>
					<available file="${lib.dir}/gndms-shared-model.jar"/>
					<available file="${lib.dir}/gndms-kit.jar"/>
				</and>
			</not>
			<then>
				<fail message="Not able to compile as '${lib.dir}/gndms-shared-model.jar' or ''${lib.dir}/gndms-kit.jar' was not found."/>
			</then>
			
			<else>
		<!-- Copy Meta files to build dir-->
		<copy todir="${logic.dest}/production">
			<fileset dir='${logic.dir}/src'>
				<exclude name="de/**"/>
			</fileset>
		</copy>
		
		<javac srcdir='${logic.dir}/src' destdir='${logic.dest}/production' classpathref="logic.path" debug="${javac.debug}"/>
	</else>
	
		</if>
		
	</target>
	
	
	<!-- Creates jar containing logic's test-classfiles-->	
	<target name="logic.test.jar"  depends="logic.compile.test" description="Creates jar file gndms-logic-test.jar in 'extra/lib'">	
		
		<jar destfile="./${lib.dir}/gndms-logic-test.jar"
		     basedir="${logic.dest}/test">
		</jar>
	</target>
	
	<!-- Creates jar containing logic's classfiles-->	
	<target name="logic.jar" depends="logic.compile" description="Creates jar file gndms-logic.jar in 'extra/lib'">	
		
		<jar destfile="./${lib.dir}/gndms-logic.jar"
		     basedir="${logic.dest}/production">
		</jar>
	</target>
	
	<path id="logic.test.path">
		<pathelement location="${lib.dir}/gndms-shared-model.jar"/>
		<pathelement location="${lib.dir}/gndms-kit.jar"/>
		<pathelement location="${lib.dir}/gndms-logic.jar"/>
		<fileset dir="${tools-lib.dir}" includes="*.jar" />
		<fileset refid="globus.lib"/>
		<dirset dir="${model.dest}/test"/>
	</path>
	
	<!-- Compile logic's test-classes-->	
	<target name="logic.compile.test" description="Compiles logic's test-files">

			
		<mkdir dir="./${logic.dest}/test"/>
		
		<javac srcdir='${logic.dir}/test-src' destdir='${logic.dest}/test' classpathref="logic.test.path" includes="**/action/*" debug="${javac.debug}">	
		</javac>
		
		<javac srcdir='${logic.dir}/test-src' destdir='${logic.dest}/test' classpathref="logic.test.path" includes="**/model/*" debug="${javac.debug}">	
		</javac>
		<!-- Copy Meta files to build dir-->
		<copy todir="${logic.dest}/test">
			<fileset dir='${logic.dir}/test-src'>
				<exclude name="de/**"/>
			</fileset>
		</copy>
	</target>
	
	<!-- Deletes binaries and jar-files -->
	<target name="logic.clean" description="Deletes logic's binaries">
		<delete includeemptydirs="true" >
			<fileset dir='${logic.dest}/production' includes="**/*.class"/>
			<fileset dir='${logic.dest}/test' includes="**/*.class"/>
			
		</delete>
	</target>
	
	<!-- Deletes jar-files -->
	<target name="logic.clean.jar" description="Deletes logic's jar-file">
		<delete file='${lib.dir}/gndms-logic.jar'/>
	</target>
</project>
	
